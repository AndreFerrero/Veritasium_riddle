With the last commit I managed to improve the elapsed time ( from 11.7 to 11.05), substituting a while loop instead of the for loop,
but the complexity remains high
